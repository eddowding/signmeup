define(["app","backbone","marionette","jspostcode","jquery.validate","syphon"],function(e,t,n){return t.Marionette.ItemView.extend({template:"#postcodeView",modelEvents:{change:"modelChanged"},modelChanged:function(){lat=this.model.get("wgs84_lat"),lon=this.model.get("wgs84_lon"),e.vent.trigger("map:panto",[lat,lon])},onRender:function(){e.vent.trigger("map:setview");var n=this.options.signup,r=this.model.get("postcode"),i=this.$el.find("form");i.validate({rules:{postcode:{required:!0,postcode:!0},name:"required",email:{required:!0,email:!0}},submitHandler:function(i){var s=t.Syphon.serialize(i);return n.set(s),n.set({postcode:r}),n.save(n.attributes,{success:function(){e.vent.trigger("map:add_marker",n),e.Router.navigate("thanks/",{trigger:!0})}}),!1}})}})});